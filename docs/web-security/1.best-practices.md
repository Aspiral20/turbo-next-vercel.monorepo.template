‚úÖ Best Practices for Access Tokens

Access tokens are short-lived credentials used to access APIs.

1. Keep Access Tokens Short-Lived

Typical lifetime: 5‚Äì15 minutes.

Short life reduces impact if stolen.

2. Store Access Tokens Securely

Browser: store in memory only (JavaScript variable, React state).
‚ùå Avoid localStorage/sessionStorage because of XSS risks.
‚ùå Avoid cookies without HttpOnly+Secure flags.

Mobile/Native apps: use secure storage (Keychain/Keystore).

3. Use HTTPS Always

Prevents interception via MITM attacks.

4. Scope Access Tokens

Grant only the minimum permissions needed (‚Äúleast privilege‚Äù).

5. Do Not Reuse or Share

Treat access tokens like passwords.

Never log or send them over email.

‚úÖ Best Practices for Refresh Tokens

Refresh tokens are long-lived credentials used to obtain new access tokens.

1. Store Refresh Tokens in the Safest Possible Location

Browser: store in an HttpOnly, Secure, SameSite=strict cookie.

Prevents JavaScript access (reducing XSS damage).

Mobile apps: secure OS-level storage.

2. Long Lifetime but Not Unlimited

Typical lifetime: 7‚Äì30 days.

Some systems rotate tokens on every use (recommended).

3. Use Refresh Token Rotation

Each time a refresh token is used, issue a new one and invalidate the old.

Prevents replay attacks if a refresh token is stolen.

4. Bind Refresh Tokens to Client + IP (optional)

Strongly increases security but may cause issues with roaming users or mobile networks.

5. Revoke on Logout

System should invalidate the refresh token when the user logs out.

6. Keep in a Database to Support Revocation

Server-side token store or opaque tokens with revocation tables.

üîí Token Renewal Logic
Recommended flow

Access token expires in 5‚Äì15 minutes.

App silently uses refresh token to get a new access token.

New access token comes with a new expiration time.

If refresh token fails ‚Üí user must log in again.

üí° Additional Best Practices
Use JWTs Carefully

Often used for access tokens, but:

don‚Äôt put sensitive data inside

keep them small

consider using opaque tokens if revocation is important

Monitor for Compromise

Detect unusual token usage (location, device, time anomalies).

Rate Limit Token Refresh Endpoints

Prevent brute-force and token guessing attacks.

| Token Type        | Lifetime            | Storage Location                           | Purpose                  |
| ----------------- | ------------------- | ------------------------------------------ | ------------------------ |
| **Access Token**  | 5‚Äì15 min            | Memory (browser) / Secure storage (mobile) | Call protected APIs      |
| **Refresh Token** | 7‚Äì30 days (rotated) | HttpOnly Secure Cookie / Secure OS storage | Obtain new access tokens |
